<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>MooneyMaker ‚Ä¢ Usuarios</title>
  <!-- Build: 2026-01-02-23-03-19 -->
  <link rel="stylesheet" href="styles.css?v=2026010320"/>
</head>

<body>
  <div class="app-nosidebar">

    <!-- TOPBAR -->
<header class="topbar">
  <div class="topbar-inner">

    <!-- Marca -->
    <div class="topbar-left">
      <span class="brand">MooneyMaker</span>
    </div>

    <!-- Bot√≥n hamburguesa (solo mobile) -->
    <button class="hamburger" id="hamburgerBtn" aria-label="Abrir men√∫" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Navegaci√≥n desktop -->
    <nav class="topbar-center nav-desktop">
      <a href="egreso.html" class="nav-item">Retiros</a>
      <a href="consulta-egresos.html" class="nav-item">Historial</a>
      <a href="usuarios.html" class="nav-item active" data-admin-only="1">Usuarios</a>
      <a href="logs.html" class="nav-item" data-requires-encargado="1">Logs</a>
    </nav>

    <!-- Acciones desktop -->
    <div class="topbar-right nav-desktop">
      <span id="whoami" class="user-badge">‚Äî</span>
      <button id="logoutBtn" class="btn-logout">Salir</button>
    </div>
  </div>

  <!-- Men√∫ mobile (drawer) -->
  <div class="mobile-drawer" id="mobileDrawer" aria-hidden="true">
    <div class="mobile-drawer-head">
      <span class="brand">MooneyMaker</span>
      <button class="drawer-close" id="closeDrawerBtn" aria-label="Cerrar men√∫">‚úï</button>
    </div>

    <nav class="mobile-nav">
      <a href="egreso.html" class="mobile-item">Retiros</a>
      <a href="consulta-egresos.html" class="mobile-item">Historial</a>
      <a href="usuarios.html" class="mobile-item active" data-admin-only="1">Usuarios</a>
      <a href="logs.html" class="mobile-item" data-requires-encargado="1">Logs</a>
    </nav>

    <div class="mobile-actions">
      <div id="whoamiMobile" class="user-badge">‚Äî</div>
      <button id="logoutBtnMobile" class="btn-logout">Salir</button>
    </div>
  </div>

  <!-- overlay -->
  <div class="drawer-overlay" id="drawerOverlay"></div>
</header>

    <main class="content-wrap">
      <div class="page">

        <section class="card">
          <div class="card-header">Administraci√≥n de usuarios</div>
          <div class="card-body">

            <!-- Crear -->
            <div class="section span12">
              <div class="section-head">
                <div class="section-title">‚ûï Crear usuario</div>
                <div class="section-subtitle">Solo admin.</div>
              </div>

              <div class="section-body grid">
                <div class="field span3">
                  <label>USERNAME *</label>
                  <input id="u_username" placeholder="ej: juan123">
                </div>

                <div class="field span3" style="position: relative;">
                  <label>PASSWORD *</label>
                  <input id="u_password" type="password" placeholder="Contrase√±a segura" style="padding-right: 40px;">
                  <button type="button" class="password-toggle" data-target="u_password" title="Mostrar/Ocultar contrase√±a" style="position: absolute; right: 8px; top: 34px; background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; opacity: 0.6; transition: opacity 0.2s;">
                    üëÅÔ∏è
                  </button>
                  <small class="note" style="display:block; margin-top:4px; font-size:11px;">
                    M√≠n 8 caracteres, may√∫scula, min√∫scula, n√∫mero y car√°cter especial
                  </small>
                </div>

                <div class="field span3" style="position: relative;">
                  <label>CONFIRMAR PASSWORD *</label>
                  <input id="u_password_confirm" type="password" placeholder="Repetir contrase√±a" style="padding-right: 40px;">
                  <button type="button" class="password-toggle" data-target="u_password_confirm" title="Mostrar/Ocultar contrase√±a" style="position: absolute; right: 8px; top: 34px; background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; opacity: 0.6; transition: opacity 0.2s;">
                    üëÅÔ∏è
                  </button>
                  <small id="password_match_indicator" class="note" style="display:block; margin-top:4px; font-size:11px; color:var(--muted);">
                    Las contrase√±as deben coincidir
                  </small>
                </div>

                <div class="field span3">
                  <label>ROL *</label>
                  <select id="u_role">
                    <option value="empleado">Empleado</option>
                    <option value="encargado">Encargado</option>
                    <option value="direccion">Direcci√≥n</option>
                    <option value="admin">Admin</option>
                  </select>
                </div>

                <div class="field span3">
                  <label>NOMBRE COMPLETO</label>
                  <input id="u_fullname" placeholder="opcional">
                </div>

                <div class="actions span12">
                  <button id="btnCreateUser" class="btn btn-primary" type="button">Crear</button>
                </div>
              </div>
            </div>

            <!-- Lista -->
            <div class="section span12" style="margin-top:12px">
              <div class="section-head">
                <div class="section-title">üìã Usuarios</div>
                <div class="section-subtitle">Editar rol, nombre, activar/desactivar, reset password.</div>
              </div>

              <div class="section-body">
                <div class="users-toolbar">
                  <input id="usersSearch" class="users-search" placeholder="Buscar por username o nombre‚Ä¶">
                  <button id="btnReloadUsers" class="btn btn-ghost" type="button">Actualizar</button>
                </div>

                <div class="table-wrap">
                  <table class="table" id="usersTable">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Username</th>
                        <th>Nombre</th>
                        <th>Rol</th>
                        <th>Activo</th>
                        <th>Creado</th>
                        <th>Acciones</th>
                      </tr>
                    </thead>
                    <tbody id="usersTbody">
                      <tr><td colspan="7" class="muted">Cargando‚Ä¶</td></tr>
                    </tbody>
                  </table>
                </div>

                <div class="note" style="margin-top:10px">
                  Tip: Desactivar usuarios en vez de borrarlos mantiene el historial y evita l√≠os con auditor√≠a.
                </div>
              </div>
            </div>

          </div>
        </section>

      </div>
    </main>

    <div id="toast" class="toast">
      <strong>‚Äî</strong><span>‚Äî</span>
    </div>

    <!-- Modal Reset Password -->
    <div id="resetPasswordModal" class="modal-backdrop" style="display: none;">
      <div class="modal" style="max-width: 400px;">
        <div class="modal-header">
          <h3>üîë Resetear Contrase√±a</h3>
          <button id="btnCloseResetModal" class="modal-close">‚úï</button>
        </div>
        <div class="modal-body">
          <div class="field" style="position: relative;">
            <label>Nueva Contrase√±a *</label>
            <input id="reset_password" type="password" placeholder="M√≠nimo 8 caracteres" style="padding-right: 40px;">
            <button type="button" class="password-toggle" data-target="reset_password" title="Mostrar/Ocultar contrase√±a" style="position: absolute; right: 8px; top: 34px; background: none; border: none; cursor: pointer; font-size: 18px; padding: 4px; opacity: 0.6; transition: opacity 0.2s;">
              üëÅÔ∏è
            </button>
            <small class="note" style="display:block; margin-top:4px; font-size:11px;">
              M√≠n 8 caracteres, may√∫scula, min√∫scula, n√∫mero y car√°cter especial
            </small>
          </div>
        </div>
        <div class="modal-footer">
          <button id="btnConfirmReset" class="btn btn-primary">Cambiar Contrase√±a</button>
          <button id="btnCancelReset" class="btn btn-ghost">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js?v=2026010320"></script>
</body>
</html>
